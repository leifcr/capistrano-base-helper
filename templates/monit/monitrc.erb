set daemon <%= fetch(:monit_daemon_time) %>
  with start delay <%= fetch(:monit_start_delay) %>

set logfile syslog facility log_daemon

set mailserver <%= fetch(:monit_mailserver) %>

set eventqueue
    basedir /var/monit  # set the base directory where events will be stored
#    slots 1000          # optionaly limit the queue size

set mail-format {
  from: <%= fetch(:monit_mail_sender) %>
  subject: $SERVICE $EVENT $HOST
  message: Monit $ACTION $SERVICE at $DATE on $HOST: $DESCRIPTION.
}
<% unless fetch(:monit_mail_reciever).nil? %>
set alert <%= fetch(:monit_mail_reciever) %> NOT ON { action, instance, pid, ppid }
<% end %>

<% unless fetch(:monit_use_httpd) == "false" %>
set httpd port <%= fetch(:monit_httpd_port) %>
  <%= "use address #{fetch(:monit_httpd_bind_address, "localhost")}" unless fetch(:monit_httpd_bind_address).nil? %>
  <%= "allow #{fetch(:monit_httpd_allow_address)}" unless fetch(:monit_httpd_allow_address).nil? %>
  <%= "signature #{fetch(:monit_httpd_signature)}" %>
<% end %>

include /etc/monit/conf.d/*.conf
